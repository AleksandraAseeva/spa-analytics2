{"ast":null,"code":"import { computed, ref, onMounted, onBeforeUnmount } from 'vue';\nexport default {\n  __name: 'TopProductsTable',\n  props: {\n    items: {\n      type: Array,\n      default: () => []\n    },\n    showChangeIndicator: {\n      type: Boolean,\n      default: true\n    },\n    showDifference: {\n      type: Boolean,\n      default: true\n    }\n  },\n  emits: ['row-click'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const isMobile = ref(false);\n    const checkScreenSize = () => {\n      isMobile.value = window.innerWidth <= 520;\n    };\n    onMounted(() => {\n      checkScreenSize();\n      window.addEventListener('resize', checkScreenSize);\n    });\n    onBeforeUnmount(() => {\n      window.removeEventListener('resize', checkScreenSize);\n    });\n    const props = __props;\n    const emit = __emit;\n    const validItems = computed(() => {\n      if (!props.items) return [];\n      // const items = props.items.filter(item => \n      //   item && \n      //   item.nm_id !== undefined && \n      //   item.current !== undefined && \n      //   item.previous !== undefined &&\n      //   item.change !== undefined\n      // );\n\n      // Если передали только один элемент (при фильтрации по артикулу)\n      if (props.items.length === 1) return props.items;\n\n      // Сортируем только если нет фильтрации по конкретному артикулу\n      return [...props.items].sort((a, b) => Math.abs(b.change) - Math.abs(a.change));\n    });\n    const shouldShowTable = computed(() => {\n      return validItems.value.length > 0;\n    });\n    const showNoDataMessage = computed(() => {\n      return !props.items || props.items.length === 0;\n    });\n    const noDataMessage = computed(() => {\n      return props.items ? 'Нет данных для отображения' : 'Данные не загружены';\n    });\n    const handleRowClick = nm_id => {\n      if (nm_id) {\n        emit('row-click', nm_id);\n      }\n    };\n    const formatNumber = value => {\n      if (typeof value !== 'number') return 'N/A';\n      return value.toFixed(2);\n    };\n    const formatChange = change => {\n      if (typeof change !== 'number') return 'N/A';\n      return `${change > 0 ? '+' : ''}${change.toFixed(2)}%`;\n    };\n    const formatDifference = (current, previous) => {\n      if (typeof current !== 'number' || typeof previous !== 'number') return 'N/A';\n      const difference = current - previous;\n      const formatted = difference.toFixed(2);\n      return difference > 0 ? `+${formatted}` : formatted;\n    };\n    const getChangeClass = item => {\n      if (item.change > 0) return 'positive';\n      if (item.change < 0) return 'negative';\n      return 'neutral';\n    };\n    const getChangeIndicator = item => {\n      if (item.change > 0) return '↑';\n      if (item.change < 0) return '↓';\n      return '→';\n    };\n    const __returned__ = {\n      isMobile,\n      checkScreenSize,\n      props,\n      emit,\n      validItems,\n      shouldShowTable,\n      showNoDataMessage,\n      noDataMessage,\n      handleRowClick,\n      formatNumber,\n      formatChange,\n      formatDifference,\n      getChangeClass,\n      getChangeIndicator,\n      computed,\n      ref,\n      onMounted,\n      onBeforeUnmount\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","ref","onMounted","onBeforeUnmount","isMobile","checkScreenSize","value","window","innerWidth","addEventListener","removeEventListener","props","__props","emit","__emit","validItems","items","length","sort","a","b","Math","abs","change","shouldShowTable","showNoDataMessage","noDataMessage","handleRowClick","nm_id","formatNumber","toFixed","formatChange","formatDifference","current","previous","difference","formatted","getChangeClass","item","getChangeIndicator"],"sources":["C:/Users/aseev/Documents/GitHub/spa-analytics2/src/components/TopProductsTable.vue"],"sourcesContent":["<template>\r\n  <div  class=\"table-container\">\r\n    <table v-if=\"shouldShowTable && !isMobile\" class=\"top-products-table\">\r\n      <thead>\r\n        <tr>\r\n          <th>Артикул</th>\r\n          <th>Текущий</th>\r\n          <th>Предыдущий</th>\r\n          <th>Изменение</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr \r\n          v-for=\"item in validItems\" \r\n          :key=\"item.nm_id\"\r\n          @click=\"handleRowClick(item.nm_id)\"\r\n          class=\"clickable-row\"\r\n        >\r\n          <td>{{ item.nm_id }}</td>\r\n          <td>{{ formatNumber(item.current) }}</td>\r\n          <td>{{ formatNumber(item.previous) }}</td>\r\n          <td :class=\"getChangeClass(item)\">\r\n            {{ formatChange(item.change) }}\r\n            <span v-if=\"showChangeIndicator\">{{ getChangeIndicator(item) }}</span>\r\n            <span v-if=\"showDifference\">&nbsp;({{ formatDifference(item.current, item.previous) }})</span>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    <!-- Мобильная версия таблицы -->\r\n    <div v-if=\"shouldShowTable && isMobile\" class=\"mobile-table\">\r\n      <div v-for=\"item in validItems\" :key=\"item.nm_id\" class=\"mobile-row\" @click=\"handleRowClick(item.nm_id)\">\r\n        <div class=\"row-header\">\r\n          <span class=\"nm-id\">Артикул: {{ item.nm_id }}</span>\r\n        </div>\r\n        <div class=\"row-data\">\r\n          <div class=\"data-item\">\r\n            <span class=\"label\">Текущий:</span>\r\n            <span class=\"value\">{{ formatNumber(item.current) }}</span>\r\n          </div>\r\n          <div class=\"data-item\">\r\n            <span class=\"label\">Предыдущий:</span>\r\n            <span class=\"value\">{{ formatNumber(item.previous) }}</span>\r\n          </div>\r\n          <div class=\"data-item\">\r\n            <span class=\"label\">Изменение:</span>\r\n            <span class=\"value\" :class=\"getChangeClass(item)\">\r\n              {{ formatChange(item.change) }}\r\n              <span v-if=\"showChangeIndicator\">{{ getChangeIndicator(item) }}</span>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <div v-if=\"showNoDataMessage\" class=\"no-data-message\">\r\n      {{ noDataMessage }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed, ref, onMounted, onBeforeUnmount  } from 'vue';\r\nimport { defineProps, defineEmits } from 'vue'; \r\n\r\nconst isMobile = ref(false);\r\n\r\nconst checkScreenSize = () => {\r\n  isMobile.value = window.innerWidth <= 520;\r\n};\r\n\r\nonMounted(() => {\r\n  checkScreenSize();\r\n  window.addEventListener('resize', checkScreenSize);\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  window.removeEventListener('resize', checkScreenSize);\r\n});\r\n\r\nconst props = defineProps({\r\n  items: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  showChangeIndicator: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showDifference: {\r\n    type: Boolean,\r\n    default: true\r\n  }\r\n});\r\n\r\nconst emit = defineEmits(['row-click']);\r\n\r\nconst validItems = computed(() => {\r\n  \r\n  if (!props.items) return [];\r\n  // const items = props.items.filter(item => \r\n  //   item && \r\n  //   item.nm_id !== undefined && \r\n  //   item.current !== undefined && \r\n  //   item.previous !== undefined &&\r\n  //   item.change !== undefined\r\n  // );\r\n\r\n  // Если передали только один элемент (при фильтрации по артикулу)\r\n  if (props.items.length === 1) return props.items;\r\n  \r\n  // Сортируем только если нет фильтрации по конкретному артикулу\r\n  return [...props.items].sort((a, b) => Math.abs(b.change) - Math.abs(a.change));\r\n});\r\n\r\nconst shouldShowTable = computed(() => {\r\n  return validItems.value.length > 0;\r\n});\r\n\r\nconst showNoDataMessage = computed(() => {\r\n  return !props.items || props.items.length === 0;\r\n});\r\n\r\nconst noDataMessage = computed(() => {\r\n  return props.items ? 'Нет данных для отображения' : 'Данные не загружены';\r\n});\r\n\r\nconst handleRowClick = (nm_id) => {\r\n  if (nm_id) {\r\n    emit('row-click', nm_id);\r\n  }\r\n};\r\n\r\nconst formatNumber = (value) => {\r\n  if (typeof value !== 'number') return 'N/A';\r\n  return value.toFixed(2);\r\n};\r\n\r\nconst formatChange = (change) => {\r\n  if (typeof change !== 'number') return 'N/A';\r\n  return `${change > 0 ? '+' : ''}${change.toFixed(2)}%`;\r\n};\r\n\r\nconst formatDifference = (current, previous) => {\r\n  if (typeof current !== 'number' || typeof previous !== 'number') return 'N/A';\r\n  const difference = current - previous;\r\n  const formatted = difference.toFixed(2);\r\n  return difference > 0 ? `+${formatted}` : formatted;\r\n};\r\n\r\nconst getChangeClass = (item) => {\r\n  if (item.change > 0) return 'positive';\r\n  if (item.change < 0) return 'negative';\r\n  return 'neutral';\r\n};\r\n\r\nconst getChangeIndicator = (item) => {\r\n  if (item.change > 0) return '↑';\r\n  if (item.change < 0) return '↓';\r\n  return '→';\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.table-container {\r\n  margin-top: 20px;\r\n  width: 100%;\r\n}\r\n\r\n.no-data-message {\r\n  padding: 16px;\r\n  text-align: center;\r\n  color: #757575;\r\n  font-style: italic;\r\n  background-color: #fafafa;\r\n  border-radius: 4px;\r\n  margin-top: 10px;\r\n}\r\n\r\n/* Стили для десктопной таблицы */\r\n.top-products-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  font-size: 14px;\r\n}\r\n\r\n.top-products-table th {\r\n  background-color: #f8f9fa;\r\n  font-weight: 600;\r\n}\r\n\r\n.top-products-table th,\r\n.top-products-table td {\r\n  padding: 10px 12px;\r\n  text-align: left;\r\n  border-bottom: 1px solid #e0e0e0;\r\n}\r\n\r\n.clickable-row {\r\n  cursor: pointer;\r\n  transition: background-color 0.2s;\r\n}\r\n\r\n.clickable-row:hover {\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.mobile-table {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  width: 100%;\r\n  font-size: 13px;\r\n}\r\n\r\n.mobile-row {\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  overflow: hidden;\r\n  cursor: pointer;\r\n  transition: transform 0.2s;\r\n}\r\n\r\n.mobile-row:active {\r\n  transform: scale(0.98);\r\n}\r\n\r\n.row-header {\r\n  padding: 12px;\r\n  background-color: #f8f9fa;\r\n  font-weight: 600;\r\n  border-bottom: 1px solid #e0e0e0;\r\n}\r\n\r\n.row-data {\r\n  padding: 12px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.data-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.label {\r\n  color: #616161;\r\n  font-weight: 500;\r\n}\r\n\r\n.value {\r\n  font-weight: 500;\r\n}\r\n\r\n.positive {\r\n  color: #2e7d32;\r\n}\r\n\r\n.negative {\r\n  color: #c62828;\r\n}\r\n\r\n.neutral {\r\n  color: #616161;\r\n}\r\n\r\n@media (max-width: 520px) {\r\n  .top-products-table {\r\n    display: none;\r\n  }\r\n  \r\n  .mobile-table {\r\n    display: flex;\r\n  }\r\n}\r\n\r\n@media (min-width: 521px) {\r\n  .mobile-table {\r\n    display: none;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}