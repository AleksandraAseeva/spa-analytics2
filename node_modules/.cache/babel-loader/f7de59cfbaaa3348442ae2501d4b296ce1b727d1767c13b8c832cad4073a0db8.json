{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"table-container\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"top-products-table\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = {\n  key: 0\n};\nconst _hoisted_5 = {\n  key: 1\n};\nconst _hoisted_6 = {\n  key: 1,\n  class: \"mobile-table\"\n};\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n  class: \"row-header\"\n};\nconst _hoisted_9 = {\n  class: \"nm-id\"\n};\nconst _hoisted_10 = {\n  class: \"row-data\"\n};\nconst _hoisted_11 = {\n  class: \"data-item\"\n};\nconst _hoisted_12 = {\n  class: \"value\"\n};\nconst _hoisted_13 = {\n  class: \"data-item\"\n};\nconst _hoisted_14 = {\n  class: \"value\"\n};\nconst _hoisted_15 = {\n  class: \"data-item\"\n};\nconst _hoisted_16 = {\n  key: 0\n};\nconst _hoisted_17 = {\n  key: 2,\n  class: \"no-data-message\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [$setup.shouldShowTable && !$setup.isMobile ? (_openBlock(), _createElementBlock(\"table\", _hoisted_2, [_cache[0] || (_cache[0] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"Артикул\"), _createElementVNode(\"th\", null, \"Текущий\"), _createElementVNode(\"th\", null, \"Предыдущий\"), _createElementVNode(\"th\", null, \"Изменение\")])], -1 /* CACHED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.validItems, item => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: item.nm_id,\n      onClick: $event => $setup.handleRowClick(item.nm_id),\n      class: \"clickable-row\"\n    }, [_createElementVNode(\"td\", null, _toDisplayString(item.nm_id), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString($setup.formatNumber(item.current)), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString($setup.formatNumber(item.previous)), 1 /* TEXT */), _createElementVNode(\"td\", {\n      class: _normalizeClass($setup.getChangeClass(item))\n    }, [_createTextVNode(_toDisplayString($setup.formatChange(item.change)) + \" \", 1 /* TEXT */), $props.showChangeIndicator ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, _toDisplayString($setup.getChangeIndicator(item)), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), $props.showDifference ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, \" (\" + _toDisplayString($setup.formatDifference(item.current, item.previous)) + \")\", 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)], 2 /* CLASS */)], 8 /* PROPS */, _hoisted_3);\n  }), 128 /* KEYED_FRAGMENT */))])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Мобильная версия таблицы \"), $setup.shouldShowTable && $setup.isMobile ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.validItems, item => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: item.nm_id,\n      class: \"mobile-row\",\n      onClick: $event => $setup.handleRowClick(item.nm_id)\n    }, [_createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"span\", _hoisted_9, \"Артикул: \" + _toDisplayString(item.nm_id), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, [_cache[1] || (_cache[1] = _createElementVNode(\"span\", {\n      class: \"label\"\n    }, \"Текущий:\", -1 /* CACHED */)), _createElementVNode(\"span\", _hoisted_12, _toDisplayString($setup.formatNumber(item.current)), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_13, [_cache[2] || (_cache[2] = _createElementVNode(\"span\", {\n      class: \"label\"\n    }, \"Предыдущий:\", -1 /* CACHED */)), _createElementVNode(\"span\", _hoisted_14, _toDisplayString($setup.formatNumber(item.previous)), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_15, [_cache[3] || (_cache[3] = _createElementVNode(\"span\", {\n      class: \"label\"\n    }, \"Изменение:\", -1 /* CACHED */)), _createElementVNode(\"span\", {\n      class: _normalizeClass([\"value\", $setup.getChangeClass(item)])\n    }, [_createTextVNode(_toDisplayString($setup.formatChange(item.change)) + \" \", 1 /* TEXT */), $props.showChangeIndicator ? (_openBlock(), _createElementBlock(\"span\", _hoisted_16, _toDisplayString($setup.getChangeIndicator(item)), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)], 2 /* CLASS */)])])], 8 /* PROPS */, _hoisted_7);\n  }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true), $setup.showNoDataMessage ? (_openBlock(), _createElementBlock(\"div\", _hoisted_17, _toDisplayString($setup.noDataMessage), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","$setup","shouldShowTable","isMobile","_hoisted_2","_createElementVNode","_Fragment","_renderList","validItems","item","key","nm_id","onClick","$event","handleRowClick","_toDisplayString","formatNumber","current","previous","_normalizeClass","getChangeClass","formatChange","change","$props","showChangeIndicator","_hoisted_4","getChangeIndicator","showDifference","_hoisted_5","formatDifference","_createCommentVNode","_hoisted_6","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","showNoDataMessage","_hoisted_17","noDataMessage"],"sources":["C:\\Users\\aseev\\Documents\\GitHub\\spa-analytics2\\src\\components\\TopProductsTable.vue"],"sourcesContent":["<template>\r\n  <div  class=\"table-container\">\r\n    <table v-if=\"shouldShowTable && !isMobile\" class=\"top-products-table\">\r\n      <thead>\r\n        <tr>\r\n          <th>Артикул</th>\r\n          <th>Текущий</th>\r\n          <th>Предыдущий</th>\r\n          <th>Изменение</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr \r\n          v-for=\"item in validItems\" \r\n          :key=\"item.nm_id\"\r\n          @click=\"handleRowClick(item.nm_id)\"\r\n          class=\"clickable-row\"\r\n        >\r\n          <td>{{ item.nm_id }}</td>\r\n          <td>{{ formatNumber(item.current) }}</td>\r\n          <td>{{ formatNumber(item.previous) }}</td>\r\n          <td :class=\"getChangeClass(item)\">\r\n            {{ formatChange(item.change) }}\r\n            <span v-if=\"showChangeIndicator\">{{ getChangeIndicator(item) }}</span>\r\n            <span v-if=\"showDifference\">&nbsp;({{ formatDifference(item.current, item.previous) }})</span>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    <!-- Мобильная версия таблицы -->\r\n    <div v-if=\"shouldShowTable && isMobile\" class=\"mobile-table\">\r\n      <div v-for=\"item in validItems\" :key=\"item.nm_id\" class=\"mobile-row\" @click=\"handleRowClick(item.nm_id)\">\r\n        <div class=\"row-header\">\r\n          <span class=\"nm-id\">Артикул: {{ item.nm_id }}</span>\r\n        </div>\r\n        <div class=\"row-data\">\r\n          <div class=\"data-item\">\r\n            <span class=\"label\">Текущий:</span>\r\n            <span class=\"value\">{{ formatNumber(item.current) }}</span>\r\n          </div>\r\n          <div class=\"data-item\">\r\n            <span class=\"label\">Предыдущий:</span>\r\n            <span class=\"value\">{{ formatNumber(item.previous) }}</span>\r\n          </div>\r\n          <div class=\"data-item\">\r\n            <span class=\"label\">Изменение:</span>\r\n            <span class=\"value\" :class=\"getChangeClass(item)\">\r\n              {{ formatChange(item.change) }}\r\n              <span v-if=\"showChangeIndicator\">{{ getChangeIndicator(item) }}</span>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <div v-if=\"showNoDataMessage\" class=\"no-data-message\">\r\n      {{ noDataMessage }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed, ref, onMounted, onBeforeUnmount  } from 'vue';\r\nimport { defineProps, defineEmits } from 'vue'; \r\n\r\nconst isMobile = ref(false);\r\n\r\nconst checkScreenSize = () => {\r\n  isMobile.value = window.innerWidth <= 520;\r\n};\r\n\r\nonMounted(() => {\r\n  checkScreenSize();\r\n  window.addEventListener('resize', checkScreenSize);\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  window.removeEventListener('resize', checkScreenSize);\r\n});\r\n\r\nconst props = defineProps({\r\n  items: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  showChangeIndicator: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showDifference: {\r\n    type: Boolean,\r\n    default: true\r\n  }\r\n});\r\n\r\nconst emit = defineEmits(['row-click']);\r\n\r\nconst validItems = computed(() => {\r\n  \r\n  if (!props.items) return [];\r\n  // const items = props.items.filter(item => \r\n  //   item && \r\n  //   item.nm_id !== undefined && \r\n  //   item.current !== undefined && \r\n  //   item.previous !== undefined &&\r\n  //   item.change !== undefined\r\n  // );\r\n\r\n  // Если передали только один элемент (при фильтрации по артикулу)\r\n  if (props.items.length === 1) return props.items;\r\n  \r\n  // Сортируем только если нет фильтрации по конкретному артикулу\r\n  return [...props.items].sort((a, b) => Math.abs(b.change) - Math.abs(a.change));\r\n});\r\n\r\nconst shouldShowTable = computed(() => {\r\n  return validItems.value.length > 0;\r\n});\r\n\r\nconst showNoDataMessage = computed(() => {\r\n  return !props.items || props.items.length === 0;\r\n});\r\n\r\nconst noDataMessage = computed(() => {\r\n  return props.items ? 'Нет данных для отображения' : 'Данные не загружены';\r\n});\r\n\r\nconst handleRowClick = (nm_id) => {\r\n  if (nm_id) {\r\n    emit('row-click', nm_id);\r\n  }\r\n};\r\n\r\nconst formatNumber = (value) => {\r\n  if (typeof value !== 'number') return 'N/A';\r\n  return value.toFixed(2);\r\n};\r\n\r\nconst formatChange = (change) => {\r\n  if (typeof change !== 'number') return 'N/A';\r\n  return `${change > 0 ? '+' : ''}${change.toFixed(2)}%`;\r\n};\r\n\r\nconst formatDifference = (current, previous) => {\r\n  if (typeof current !== 'number' || typeof previous !== 'number') return 'N/A';\r\n  const difference = current - previous;\r\n  const formatted = difference.toFixed(2);\r\n  return difference > 0 ? `+${formatted}` : formatted;\r\n};\r\n\r\nconst getChangeClass = (item) => {\r\n  if (item.change > 0) return 'positive';\r\n  if (item.change < 0) return 'negative';\r\n  return 'neutral';\r\n};\r\n\r\nconst getChangeIndicator = (item) => {\r\n  if (item.change > 0) return '↑';\r\n  if (item.change < 0) return '↓';\r\n  return '→';\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.table-container {\r\n  margin-top: 20px;\r\n  width: 100%;\r\n}\r\n\r\n.no-data-message {\r\n  padding: 16px;\r\n  text-align: center;\r\n  color: #757575;\r\n  font-style: italic;\r\n  background-color: #fafafa;\r\n  border-radius: 4px;\r\n  margin-top: 10px;\r\n}\r\n\r\n/* Стили для десктопной таблицы */\r\n.top-products-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  font-size: 14px;\r\n}\r\n\r\n.top-products-table th {\r\n  background-color: #f8f9fa;\r\n  font-weight: 600;\r\n}\r\n\r\n.top-products-table th,\r\n.top-products-table td {\r\n  padding: 10px 12px;\r\n  text-align: left;\r\n  border-bottom: 1px solid #e0e0e0;\r\n}\r\n\r\n.clickable-row {\r\n  cursor: pointer;\r\n  transition: background-color 0.2s;\r\n}\r\n\r\n.clickable-row:hover {\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.mobile-table {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  width: 100%;\r\n  font-size: 13px;\r\n}\r\n\r\n.mobile-row {\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  overflow: hidden;\r\n  cursor: pointer;\r\n  transition: transform 0.2s;\r\n}\r\n\r\n.mobile-row:active {\r\n  transform: scale(0.98);\r\n}\r\n\r\n.row-header {\r\n  padding: 12px;\r\n  background-color: #f8f9fa;\r\n  font-weight: 600;\r\n  border-bottom: 1px solid #e0e0e0;\r\n}\r\n\r\n.row-data {\r\n  padding: 12px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.data-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.label {\r\n  color: #616161;\r\n  font-weight: 500;\r\n}\r\n\r\n.value {\r\n  font-weight: 500;\r\n}\r\n\r\n.positive {\r\n  color: #2e7d32;\r\n}\r\n\r\n.negative {\r\n  color: #c62828;\r\n}\r\n\r\n.neutral {\r\n  color: #616161;\r\n}\r\n\r\n@media (max-width: 520px) {\r\n  .top-products-table {\r\n    display: none;\r\n  }\r\n  \r\n  .mobile-table {\r\n    display: flex;\r\n  }\r\n}\r\n\r\n@media (min-width: 521px) {\r\n  .mobile-table {\r\n    display: none;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}